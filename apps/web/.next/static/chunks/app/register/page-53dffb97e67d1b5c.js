(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{40:(e,a,i)=>{Promise.resolve().then(i.bind(i,79795))},36543:(e,a,i)=>{"use strict";i.d(a,{P:()=>d});var t=i(33055),s=i(54953),l=i(441),n=i(14532),r=i(53995);function d(){let{chainId:e}=(0,t.F)(),a=(0,n.RZ)("DESTOCK",null!=e?e:31337),{data:i,refetch:d}=(0,s.Q)({abi:n.$B,address:a,functionName:"nextCompanyId"}),{writeContractAsync:c,isPending:o,error:m}=(0,l.x)(),u=async(e,i,t,s)=>{await c({abi:n.$B,address:a,functionName:"registerCompany",args:[e,BigInt(t),(0,r.g)(i),s]}),d()},{writeContractAsync:p}=(0,l.x)(),{writeContractAsync:y}=(0,l.x)();return{nextCompanyId:Number(i),registerCompany:u,isPending:o,error:m,getCompany:e=>(0,s.Q)({abi:n.$B,address:a,functionName:"companies",args:[BigInt(e)]}),getSharePrice:e=>(0,s.Q)({abi:n.$B,address:a,functionName:"getSharePrice",args:[BigInt(e)]}),getShareBalance:(e,i)=>(0,s.Q)({abi:n.$B,address:a,functionName:"balanceOf",args:[i,BigInt(e)]}),buyShares:p,sellShares:y}}},79795:(e,a,i)=>{"use strict";i.d(a,{CompanyRegistry:()=>x});var t=i(54568),s=i(7620),l=i(61938),n=i(90060),r=i(68072),d=i(36543),c=i(33055),o=i(29548),m=i(61744),u=i.n(m),p=i(54953),y=i(14532);let h=r.Ik({name:r.Yj().min(1,"Company name is required").max(50,"Name too long"),totalSupply:r.Yj().min(1,"Total supply is required"),initialLiquidity:r.Yj().min(1,"Initial liquidity is required").refine(e=>parseFloat(e)>10,{message:"Initial liquidity must be greater than 10 DSTK"})});function x(){let{isConnected:e,address:a,chainId:i}=(0,c.F)(),{registerCompany:r,isPending:m,error:x}=(0,d.P)(),[g,b]=(0,s.useState)(null),N=(0,y.RZ)("DSTK_TOKEN",null!=i?i:31337),{data:f}=(0,p.Q)({abi:y.MO,address:N,functionName:"balanceOf",args:[a],query:{enabled:!!a}}),j=f?parseFloat((0,o.J)(f,18)):0,{register:S,handleSubmit:q,formState:{errors:v},reset:k,watch:w}=(0,l.mN)({resolver:(0,n.u)(h)}),C=w(),L=async a=>{if(!e)return void alert("Please connect your wallet first");if(!g)return void alert("Please upload a company logo.");if(j<parseFloat(a.initialLiquidity))return void alert("Insufficient DSTK balance.");try{let e=await u().upload(g,"04d8c0bd.ea10877fd8fe4eb59bc905b1620ae30a"),i="https://gateway.lighthouse.storage/ipfs/".concat(e.data.Hash),t={name:a.name,logo:i,totalSupply:a.totalSupply,initialLiquidity:a.initialLiquidity},s=new Blob([JSON.stringify(t)],{type:"application/json"}),l=new File([s],"metadata.json"),n=await u().upload(l,"04d8c0bd.ea10877fd8fe4eb59bc905b1620ae30a"),d="ipfs://".concat(n.data.Hash);await r(a.name,a.totalSupply,a.initialLiquidity,d),k(),b(null)}catch(e){console.error("Registration failed:",e)}};return e?(0,t.jsx)("div",{className:"destock-card",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-6",children:"Register Your Company"}),(0,t.jsxs)("form",{onSubmit:q(L),className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"name",children:"Company Name"}),(0,t.jsx)("input",{...S("name"),type:"text",id:"name",className:"destock-input",placeholder:"Enter company name"}),v.name&&(0,t.jsx)("p",{className:"mt-1 text-sm danger",children:v.name.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"totalSupply",children:"Total Share Supply"}),(0,t.jsx)("input",{...S("totalSupply"),type:"number",min:"1",id:"totalSupply",className:"destock-input",placeholder:"1000"}),v.totalSupply&&(0,t.jsx)("p",{className:"mt-1 text-sm danger",children:v.totalSupply.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"initialLiquidity",children:"Initial Liquidity (DSTK)"}),(0,t.jsx)("input",{...S("initialLiquidity"),type:"number",step:"0.01",min:"10.01",id:"initialLiquidity",className:"destock-input",placeholder:"10000"}),v.initialLiquidity&&(0,t.jsx)("p",{className:"mt-1 text-sm danger",children:v.initialLiquidity.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"logo",children:"Company Logo"}),(0,t.jsx)("input",{type:"file",id:"logo",accept:"image/*",className:"destock-input",onChange:e=>{var a;return b((null==(a=e.target.files)?void 0:a[0])||null)},required:!0})]}),(0,t.jsxs)("div",{className:"bg-high-visibility p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-high-contrast mb-2",children:"Registration Requirements"}),(0,t.jsx)("div",{className:"space-y-1 text-sm text-medium-contrast",children:(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Initial Liquidity:"}),(0,t.jsxs)("span",{children:[C.initialLiquidity?parseFloat(C.initialLiquidity).toFixed(2):"0.00"," ","DSTK"]})]})}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-low-contrast",children:["Your Balance: ",j," DSTK"]}),(0,t.jsx)("div",{className:"mt-2 text-xs text-low-contrast",children:"* Minimum required: 10.01 DSTK"})]}),x&&(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:(0,t.jsxs)("p",{className:"text-sm danger",children:["Registration failed: ",x.message]})}),(0,t.jsx)("button",{type:"submit",disabled:m||j<parseFloat(C.initialLiquidity||"0")||!g,className:"w-full destock-button-primary disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Processing...":j<parseFloat(C.initialLiquidity||"0")?"Insufficient Balance":"Register Company"})]})]})}):(0,t.jsxs)("div",{className:"destock-card text-center py-8",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-2",children:"Connect Your Wallet"}),(0,t.jsx)("p",{className:"text-medium-contrast",children:"Please connect your wallet to register a company."})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[567,55,823,599,744,532,587,315,358],()=>a(40)),_N_E=e.O()}]);