(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{40:(e,a,t)=>{Promise.resolve().then(t.bind(t,79795))},36543:(e,a,t)=>{"use strict";t.d(a,{P:()=>d});var i=t(33055),s=t(54953),r=t(441),n=t(14532),l=t(53995);function d(){let{chainId:e}=(0,i.F)(),a=(0,n.RZ)("DESTOCK",null!=e?e:31337),{data:t,refetch:d}=(0,s.Q)({abi:n.$B,address:a,functionName:"nextCompanyId"}),{writeContractAsync:c,isPending:o,error:m}=(0,r.x)(),p=async(e,t,i)=>{await c({abi:n.$B,address:a,functionName:"registerCompany",args:[e,(0,l.g)(i),BigInt(t)]}),d()},{writeContractAsync:u}=(0,r.x)(),{writeContractAsync:x}=(0,r.x)();return{nextCompanyId:Number(t),registerCompany:p,isPending:o,error:m,getCompany:e=>(0,s.Q)({abi:n.$B,address:a,functionName:"companies",args:[BigInt(e)]}),getSharePrice:e=>(0,s.Q)({abi:n.$B,address:a,functionName:"getSharePrice",args:[BigInt(e)]}),getShareBalance:(e,t)=>(0,s.Q)({abi:n.$B,address:a,functionName:"balanceOf",args:[t,BigInt(e)]}),buyShares:u,sellShares:x}}},79795:(e,a,t)=>{"use strict";t.d(a,{CompanyRegistry:()=>u});var i=t(54568),s=t(7620),r=t(61938),n=t(90060),l=t(68072),d=t(36543),c=t(80660),o=t(33055),m=t(29548);let p=l.Ik({name:l.Yj().min(1,"Company name is required").max(50,"Name too long"),totalSupply:l.Yj().min(1,"Total supply is required"),initialLiquidity:l.Yj().min(1,"Initial liquidity is required"),ipfsMetadataUri:l.Yj().min(1,"IPFS Metadata URI is required")});function u(){let{isConnected:e,address:a,chainId:t}=(0,o.F)(),{registerCompany:l,isPending:u,error:x}=(0,d.P)(),{balance:y,approve:h,allowance:b,isApproving:g}=(0,c.W)(),[f,j]=(0,s.useState)(!0),{register:N,handleSubmit:S,formState:{errors:v},reset:C,watch:w}=(0,r.mN)({resolver:(0,n.u)(p)}),k=w(),F=k.initialLiquidity?(parseFloat(k.initialLiquidity)+100).toString():"100",q=async()=>{if(!e||!a||!b)return;let t=y?parseFloat((0,m.J)(y,18)):0,i=parseFloat(F);if(t<i)return void j(!0);j(parseFloat((0,m.J)(b,18))<i)};(0,s.useState)(()=>{q()});let I=async()=>{a&&h(F)},T=async a=>{if(!e)return void alert("Please connect your wallet first");if((y?parseFloat((0,m.J)(y,18)):0)<parseFloat(F))return void alert("Insufficient DSTK balance.");try{await l(a.name,a.initialLiquidity,a.totalSupply),C()}catch(e){console.error("Registration failed:",e)}};return e?(0,i.jsx)("div",{className:"destock-card",children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-6",children:"Register Your Company"}),(0,i.jsxs)("form",{onSubmit:S(T),className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"name",children:"Company Name"}),(0,i.jsx)("input",{...N("name"),type:"text",id:"name",className:"destock-input",placeholder:"Enter company name"}),v.name&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:v.name.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"totalSupply",children:"Total Share Supply"}),(0,i.jsx)("input",{...N("totalSupply"),type:"number",min:"1",id:"totalSupply",className:"destock-input",placeholder:"1000"}),v.totalSupply&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:v.totalSupply.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"initialLiquidity",children:"Initial Liquidity (DSTK)"}),(0,i.jsx)("input",{...N("initialLiquidity"),type:"number",step:"0.01",min:"10",id:"initialLiquidity",className:"destock-input",placeholder:"10000"}),v.initialLiquidity&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:v.initialLiquidity.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"ipfsMetadataUri",children:"IPFS Metadata URI"}),(0,i.jsx)("input",{...N("ipfsMetadataUri"),type:"text",id:"ipfsMetadataUri",className:"destock-input",placeholder:"ipfs://..."}),v.ipfsMetadataUri&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:v.ipfsMetadataUri.message})]}),(0,i.jsxs)("div",{className:"bg-high-visibility p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,i.jsx)("h4",{className:"text-sm font-medium text-high-contrast mb-2",children:"Cost Breakdown"}),(0,i.jsxs)("div",{className:"space-y-1 text-sm text-medium-contrast",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"Registration Fee:"}),(0,i.jsx)("span",{children:"100 DSTK"})]}),k.initialLiquidity&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"Initial Liquidity:"}),(0,i.jsxs)("span",{children:[parseFloat(k.initialLiquidity).toFixed(2)," DSTK"]})]}),(0,i.jsxs)("div",{className:"flex justify-between font-medium border-t border-gray-300 dark:border-gray-600 pt-1 text-high-contrast",children:[(0,i.jsx)("span",{children:"Total Cost:"}),(0,i.jsxs)("span",{children:[F," DSTK"]})]})]}),(0,i.jsxs)("div",{className:"mt-2 text-xs text-low-contrast",children:["Your Balance: ",y?(0,m.J)(y,18):0," DSTK"]})]}),x&&(0,i.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:(0,i.jsxs)("p",{className:"text-sm danger",children:["Registration failed: ",x.message]})}),f?(0,i.jsx)("button",{type:"button",onClick:I,disabled:g||u,className:"w-full destock-button-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Approving...":"Approve DSTK"}):(0,i.jsx)("button",{type:"submit",disabled:u||(y?parseFloat((0,m.J)(y,18)):0)<parseFloat(F),className:"w-full destock-button-primary disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Processing...":(y?parseFloat((0,m.J)(y,18)):0)<parseFloat(F)?"Insufficient Balance":"Register Company"})]})]})}):(0,i.jsxs)("div",{className:"destock-card text-center py-8",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-2",children:"Connect Your Wallet"}),(0,i.jsx)("p",{className:"text-medium-contrast",children:"Please connect your wallet to register a company."})]})}},80660:(e,a,t)=>{"use strict";t.d(a,{W:()=>d});var i=t(33055),s=t(54953),r=t(441),n=t(14532),l=t(53995);function d(){let{address:e,chainId:a}=(0,i.F)(),t=(0,n.RZ)("DSTK_TOKEN",null!=a?a:31337),d=(0,n.RZ)("DESTOCK",null!=a?a:31337),c=null!=e?e:"0x0000000000000000000000000000000000000000",{data:o,refetch:m}=(0,s.Q)({abi:n.MO,address:t,functionName:"balanceOf",args:[c]}),{data:p,refetch:u}=(0,s.Q)({abi:n.MO,address:t,functionName:"allowance",args:[c,d]}),{writeContractAsync:x,isPending:y}=(0,r.x)(),h=async e=>{await x({abi:n.MO,address:t,functionName:"approve",args:[d,(0,l.g)(e)]}),u()},{writeContractAsync:b}=(0,r.x)(),{writeContractAsync:g}=(0,r.x)(),{writeContractAsync:f}=(0,r.x)();return{balance:o,allowance:p,approve:h,isApproving:y,mint:b,transferFromContract:g,batchAirDrop:f,refetchBalance:m,refetchAllowance:u}}}},e=>{var a=a=>e(e.s=a);e.O(0,[55,823,599,532,587,315,358],()=>a(40)),_N_E=e.O()}]);