(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{40:(e,a,t)=>{Promise.resolve().then(t.bind(t,79795))},36543:(e,a,t)=>{"use strict";t.d(a,{P:()=>d});var i=t(33055),s=t(54953),r=t(441),n=t(14532),l=t(53995);function d(){let{chainId:e}=(0,i.F)(),a=(0,n.RZ)("DESTOCK",null!=e?e:31337),{data:t,refetch:d}=(0,s.Q)({abi:n.$B,address:a,functionName:"nextCompanyId"}),{writeContractAsync:c,isPending:o,isConfirming:m,isConfirmed:u,error:p}=(0,r.x)(),x=async(e,t,i,s)=>{await c({abi:n.$B,address:a,functionName:"registerCompany",args:[e,BigInt(t),(0,l.g)(i),s]}),d()},{writeContractAsync:y}=(0,r.x)(),{writeContractAsync:g}=(0,r.x)();return{nextCompanyId:Number(t),registerCompany:x,isPending:o,isConfirming:m,isConfirmed:u,error:p,getCompany:e=>(0,s.Q)({abi:n.$B,address:a,functionName:"getCompanyDetails",args:[BigInt(e)]}),getSharePrice:e=>(0,s.Q)({abi:n.$B,address:a,functionName:"getSharePrice",args:[BigInt(e)]}),getBuyPrice:(e,t)=>(0,s.Q)({abi:n.$B,address:a,functionName:"getBuyPrice",args:[BigInt(e),BigInt(t)]}),getSellPrice:(e,t)=>(0,s.Q)({abi:n.$B,address:a,functionName:"getSellPrice",args:[BigInt(e),BigInt(t)]}),buyShares:y,sellShares:g}}},79795:(e,a,t)=>{"use strict";t.d(a,{CompanyRegistry:()=>p});var i=t(54568),s=t(7620),r=t(61938),n=t(90060),l=t(68072),d=t(36543),c=t(80660),o=t(33055),m=t(29548);let u=l.Ik({name:l.Yj().min(1,"Company name is required").max(50,"Name too long"),totalSupply:l.Yj().min(1,"Total supply is required"),initialLiquidity:l.Yj().min(1,"Initial liquidity is required"),ipfsMetadataUri:l.Yj().min(1,"IPFS Metadata URI is required")});function p(){let{isConnected:e,address:a,chainId:t}=(0,o.F)(),{registerCompany:l,isPending:p,isConfirming:x,isConfirmed:y,error:g}=(0,d.P)(),{balance:h,approve:b,allowance:f,isApproving:j}=(0,c.W)(),[N,S]=(0,s.useState)(!0),{register:v,handleSubmit:C,formState:{errors:k},reset:w,watch:F}=(0,r.mN)({resolver:(0,n.u)(u)}),I=F(),q=I.initialLiquidity?(parseFloat(I.initialLiquidity)+100).toString():"100",B=async()=>{if(!e||!a||!f)return;let t=h?parseFloat((0,m.J)(h,18)):0,i=parseFloat(q);if(t<i)return void S(!0);S(parseFloat((0,m.J)(f,18))<i)};(0,s.useState)(()=>{B()});let P=async()=>{a&&b(q)},T=async a=>{if(!e)return void alert("Please connect your wallet first");if((h?parseFloat((0,m.J)(h,18)):0)<parseFloat(q))return void alert("Insufficient DSTK balance.");try{await l(a.name,a.totalSupply,a.initialLiquidity,a.ipfsMetadataUri),w()}catch(e){console.error("Registration failed:",e)}};return e?(0,i.jsx)("div",{className:"destock-card",children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-6",children:"Register Your Company"}),(0,i.jsxs)("form",{onSubmit:C(T),className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"name",children:"Company Name"}),(0,i.jsx)("input",{...v("name"),type:"text",id:"name",className:"destock-input",placeholder:"Enter company name"}),k.name&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:k.name.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"totalSupply",children:"Total Share Supply"}),(0,i.jsx)("input",{...v("totalSupply"),type:"number",min:"1",id:"totalSupply",className:"destock-input",placeholder:"1000"}),k.totalSupply&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:k.totalSupply.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"initialLiquidity",children:"Initial Liquidity (DSTK)"}),(0,i.jsx)("input",{...v("initialLiquidity"),type:"number",step:"0.01",min:"10",id:"initialLiquidity",className:"destock-input",placeholder:"10000"}),k.initialLiquidity&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:k.initialLiquidity.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"destock-label",htmlFor:"ipfsMetadataUri",children:"IPFS Metadata URI"}),(0,i.jsx)("input",{...v("ipfsMetadataUri"),type:"text",id:"ipfsMetadataUri",className:"destock-input",placeholder:"ipfs://..."}),k.ipfsMetadataUri&&(0,i.jsx)("p",{className:"mt-1 text-sm danger",children:k.ipfsMetadataUri.message})]}),(0,i.jsxs)("div",{className:"bg-high-visibility p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,i.jsx)("h4",{className:"text-sm font-medium text-high-contrast mb-2",children:"Cost Breakdown"}),(0,i.jsxs)("div",{className:"space-y-1 text-sm text-medium-contrast",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"Registration Fee:"}),(0,i.jsx)("span",{children:"100 DSTK"})]}),I.initialLiquidity&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"Initial Liquidity:"}),(0,i.jsxs)("span",{children:[parseFloat(I.initialLiquidity).toFixed(2)," DSTK"]})]}),(0,i.jsxs)("div",{className:"flex justify-between font-medium border-t border-gray-300 dark:border-gray-600 pt-1 text-high-contrast",children:[(0,i.jsx)("span",{children:"Total Cost:"}),(0,i.jsxs)("span",{children:[q," DSTK"]})]})]}),(0,i.jsxs)("div",{className:"mt-2 text-xs text-low-contrast",children:["Your Balance: ",h?(0,m.J)(h,18):0," DSTK"]})]}),g&&(0,i.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:(0,i.jsxs)("p",{className:"text-sm danger",children:["Registration failed: ",g.message]})}),N?(0,i.jsx)("button",{type:"button",onClick:P,disabled:j||p||x,className:"w-full destock-button-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Approving...":"Approve DSTK"}):(0,i.jsx)("button",{type:"submit",disabled:p||x||(h?parseFloat((0,m.J)(h,18)):0)<parseFloat(q),className:"w-full destock-button-primary disabled:opacity-50 disabled:cursor-not-allowed",children:p||x?"Processing...":(h?parseFloat((0,m.J)(h,18)):0)<parseFloat(q)?"Insufficient Balance":"Register Company"}),y&&(0,i.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:(0,i.jsx)("p",{className:"text-sm success",children:"Company registered successfully! \uD83C\uDF89"})})]})]})}):(0,i.jsxs)("div",{className:"destock-card text-center py-8",children:[(0,i.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-2",children:"Connect Your Wallet"}),(0,i.jsx)("p",{className:"text-medium-contrast",children:"Please connect your wallet to register a company."})]})}},80660:(e,a,t)=>{"use strict";t.d(a,{W:()=>d});var i=t(33055),s=t(54953),r=t(441),n=t(14532),l=t(53995);function d(){let{address:e,chainId:a}=(0,i.F)(),t=(0,n.RZ)("DSTK_TOKEN",null!=a?a:31337),d=(0,n.RZ)("DESTOCK",null!=a?a:31337),{data:c,refetch:o}=(0,s.Q)({abi:n.MO,address:t,functionName:"balanceOf",args:[e]}),{data:m,refetch:u}=(0,s.Q)({abi:n.MO,address:t,functionName:"allowance",args:[e,d]}),{writeContractAsync:p,isPending:x}=(0,r.x)(),y=async e=>{await p({abi:n.MO,address:t,functionName:"approve",args:[d,(0,l.g)(e)]}),u()},{writeContractAsync:g}=(0,r.x)(),{writeContractAsync:h}=(0,r.x)(),{writeContractAsync:b}=(0,r.x)();return{balance:c,allowance:m,approve:y,isApproving:x,mint:g,transferFromContract:h,batchAirDrop:b,refetchBalance:o,refetchAllowance:u}}}},e=>{var a=a=>e(e.s=a);e.O(0,[55,823,599,532,587,315,358],()=>a(40)),_N_E=e.O()}]);