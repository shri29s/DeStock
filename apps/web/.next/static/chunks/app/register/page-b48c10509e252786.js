(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{36543:(e,a,s)=>{"use strict";s.d(a,{P:()=>o});var t=s(33055),i=s(441),r=s(34072),l=s(54953),n=s(14532),c=s(7620),d=s(53995);function o(){let{address:e,chainId:a}=(0,t.F)(),s=(0,c.useMemo)(()=>{if(a)return(0,n.RZ)("DESTOCK",a)},[a]),{writeContract:o,data:m,error:u,isPending:p}=(0,i.x)(),{isLoading:x,isSuccess:h}=(0,r.g)({hash:m}),{data:g}=(0,l.Q)({address:s,abi:n.$B,functionName:"nextCompanyId"}),b=(0,c.useCallback)(e=>(0,l.Q)({address:s,abi:n.$B,functionName:"companies",args:[BigInt(e)]}),[s]),y=(0,c.useCallback)(e=>(0,l.Q)({address:s,abi:n.$B,functionName:"getSharePrice",args:[BigInt(e)]}),[s]),j=(0,c.useCallback)((a,t)=>{let i=t||e;return(0,l.Q)({address:s,abi:n.$B,functionName:"balanceOf",args:i?[i,BigInt(a)]:void 0,query:{enabled:!!i}})},[s,e]),N=(0,c.useCallback)((e,a,t)=>{s&&o({address:s,abi:n.$B,functionName:"registerCompany",args:[e,(0,d.g)(a),BigInt(t)]})},[s,o]),f=(0,c.useCallback)((e,a)=>{s&&o({address:s,abi:n.$B,functionName:"buyShares",args:[BigInt(e),BigInt(a)]})},[s,o]),S=(0,c.useCallback)((e,a)=>{s&&o({address:s,abi:n.$B,functionName:"sellShares",args:[BigInt(e),BigInt(a)]})},[s,o]);return{contractAddress:s,nextCompanyId:g?Number(g):0,getCompany:b,getSharePrice:y,getShareBalance:j,registerCompany:N,buyShares:f,sellShares:S,hash:m,isPending:p,isConfirming:x,isConfirmed:h,error:u}}},79795:(e,a,s)=>{"use strict";s.d(a,{CompanyRegistry:()=>u});var t=s(54568),i=s(7620),r=s(61938),l=s(90060),n=s(68072),c=s(36543),d=s(66888),o=s(33055);let m=n.Ik({name:n.Yj().min(1,"Company name is required").max(50,"Name too long"),initialPrice:n.Yj().min(1,"Initial price is required"),totalSupply:n.Yj().min(1,"Total supply is required")});function u(){let{isConnected:e,address:a}=(0,o.F)(),{registerCompany:s,isPending:n,isConfirming:u,isConfirmed:p,error:x}=(0,c.P)(),{balance:h,approve:g,getAllowance:b}=(0,d.O)(),[y,j]=(0,i.useState)(!0),{register:N,handleSubmit:f,formState:{errors:S},reset:k,watch:v}=(0,r.mN)({resolver:(0,l.u)(m)}),C=v(),P=C.initialPrice&&C.totalSupply?(parseFloat(C.initialPrice)*parseFloat(C.totalSupply)+100).toString():"100",B=async a=>{if(!e)return void alert("Please connect your wallet first");if(100>parseFloat(h))return void alert("Insufficient DSTK balance. You need at least 100 DSTK to register a company.");try{await s(a.name,a.initialPrice,a.totalSupply),k()}catch(e){console.error("Registration failed:",e)}};return e?(0,t.jsx)("div",{className:"destock-card",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-6",children:"Register Your Company"}),(0,t.jsxs)("form",{onSubmit:f(B),className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"name",children:"Company Name"}),(0,t.jsx)("input",{...N("name"),type:"text",id:"name",className:"destock-input",placeholder:"Enter company name"}),S.name&&(0,t.jsx)("p",{className:"mt-1 text-sm danger",children:S.name.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"initialPrice",children:"Initial Share Price (DSTK)"}),(0,t.jsx)("input",{...N("initialPrice"),type:"number",step:"0.01",min:"0.01",id:"initialPrice",className:"destock-input",placeholder:"10.00"}),S.initialPrice&&(0,t.jsx)("p",{className:"mt-1 text-sm danger",children:S.initialPrice.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"totalSupply",children:"Total Share Supply"}),(0,t.jsx)("input",{...N("totalSupply"),type:"number",min:"1",id:"totalSupply",className:"destock-input",placeholder:"1000"}),S.totalSupply&&(0,t.jsx)("p",{className:"mt-1 text-sm danger",children:S.totalSupply.message})]}),(0,t.jsxs)("div",{className:"bg-high-visibility p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-high-contrast mb-2",children:"Cost Breakdown"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-medium-contrast",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Registration Fee:"}),(0,t.jsx)("span",{children:"100 DSTK"})]}),C.initialPrice&&C.totalSupply&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Initial Liquidity:"}),(0,t.jsxs)("span",{children:[(parseFloat(C.initialPrice)*parseFloat(C.totalSupply)).toFixed(2)," DSTK"]})]}),(0,t.jsxs)("div",{className:"flex justify-between font-medium border-t border-gray-300 dark:border-gray-600 pt-1 text-high-contrast",children:[(0,t.jsx)("span",{children:"Total Cost:"}),(0,t.jsxs)("span",{children:[P," DSTK"]})]})]}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-low-contrast",children:["Your Balance: ",h," DSTK"]})]}),x&&(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg border border-red-200 dark:border-red-800",children:(0,t.jsxs)("p",{className:"text-sm danger",children:["Registration failed: ",x.message]})}),(0,t.jsx)("button",{type:"submit",disabled:n||u||parseFloat(h)<parseFloat(P),className:"w-full destock-button-primary disabled:opacity-50 disabled:cursor-not-allowed",children:n||u?"Processing...":parseFloat(h)<parseFloat(P)?"Insufficient Balance":"Register Company"}),p&&(0,t.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:(0,t.jsx)("p",{className:"text-sm success",children:"Company registered successfully! \uD83C\uDF89"})})]})]})}):(0,t.jsxs)("div",{className:"destock-card text-center py-8",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-high-contrast mb-2",children:"Connect Your Wallet"}),(0,t.jsx)("p",{className:"text-medium-contrast",children:"Please connect your wallet to register a company."})]})}},84169:(e,a,s)=>{Promise.resolve().then(s.bind(s,79795))}},e=>{var a=a=>e(e.s=a);e.O(0,[850,599,888,587,315,358],()=>a(84169)),_N_E=e.O()}]);