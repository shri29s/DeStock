(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{19184:(e,a,t)=>{"use strict";t.d(a,{k:()=>u});var s=t(54568),r=t(7620),i=t(63557),n=t(81636),l=t(21752),c=t(66734),o=t(22935),d=t(35551),m=t(7886),x=t(39818);let h=[];function u(e){let{symbol:a="DEMO",data:t=h,height:u=400,showTimeframes:g=!0,showIndicators:p=!0,className:y=""}=e,b=(0,r.useRef)(null),f=(0,r.useRef)(null),v=(0,r.useRef)(null),j=(0,r.useRef)(h),[N,w]=(0,r.useState)("1D"),[k,C]=(0,r.useState)("candlestick"),[S,P]=(0,r.useState)(!0),[E,M]=(0,r.useState)([]),{theme:A}=(0,l.D)();(0,r.useEffect)(()=>{if(!b.current)return;let e="dark"===A,a=(0,i.R9)(b.current,{width:b.current.clientWidth,height:u,layout:{background:{type:i.mE.Solid,color:"transparent"},textColor:e?"#E5E7EB":"#374151"},grid:{vertLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},horzLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},crosshair:{mode:1},timeScale:{borderColor:e?"#374151":"#D1D5DB",timeVisible:!0,secondsVisible:!1},rightPriceScale:{borderColor:e?"#374151":"#D1D5DB"}}),t=a.addCandlestickSeries({upColor:"#00D4AA",downColor:"#F6465D",borderDownColor:"#F6465D",borderUpColor:"#00D4AA",wickDownColor:"#F6465D",wickUpColor:"#00D4AA"});f.current=a,v.current=t;let s=()=>{b.current&&f.current&&f.current.applyOptions({width:b.current.clientWidth})};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),f.current&&(f.current.remove(),f.current=null,v.current=null)}},[u,A]),(0,r.useEffect)(()=>{if(!f.current)return;let e="dark"===A;f.current.applyOptions({layout:{background:{type:i.mE.Solid,color:"transparent"},textColor:e?"#E5E7EB":"#374151"},grid:{vertLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},horzLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},timeScale:{borderColor:e?"#374151":"#D1D5DB"},rightPriceScale:{borderColor:e?"#374151":"#D1D5DB"}})},[A]),(0,r.useEffect)(()=>{t!==j.current&&t.length>0&&t!==h&&(console.log("TradingChart: Using provided data",t.length,"points"),j.current=t,M(t),P(!1))},[t]),(0,r.useEffect)(()=>{(async()=>{if(!(t.length>0)||t===h){console.log("TradingChart: Loading data from API",{symbol:a,selectedTimeframe:N}),P(!0);try{let e=await fetch("/api/market?type=chart&symbol=".concat(a,"&timeframe=").concat(N,"&days=30")),t=await e.json();if(e.ok&&t.data&&t.data.ohlc){let e=(t.data.ohlc||[]).map(e=>({...e,time:e.time}));console.log("TradingChart: API data loaded",e.length,"points"),M(e)}else console.warn("Failed to fetch chart data:",t),M([]);P(!1)}catch(e){console.error("Failed to load chart data:",e),M([]),P(!1)}}})()},[a,N]),(0,r.useEffect)(()=>{v.current&&0!==E.length&&(v.current.setData(E),f.current&&f.current.timeScale().fitContent())},[E]);let D=e=>{w(e)},F=E.length>0?E[E.length-1].close:0,T=E.length>1?E[E.length-2].close:F,L=F-T,z=T>0?L/T*100:0,H=L>=0;return(0,s.jsxs)("div",{className:"glass-card ".concat(y),children:[(0,s.jsxs)("div",{className:"p-4 border-b border-white/10 dark:border-black/10",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("span",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["$",F.toFixed(2)]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 ".concat(H?"text-success":"text-danger"),children:[H?(0,s.jsx)(c.A,{className:"w-4 h-4"}):(0,s.jsx)(o.A,{className:"w-4 h-4"}),(0,s.jsxs)("span",{className:"font-medium",children:[H?"+":"",L.toFixed(2)," (",z.toFixed(2),"%)"]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(n.P.button,{onClick:()=>C("candlestick"),className:"p-2 rounded-md transition-colors duration-200 ".concat("candlestick"===k?"bg-destock-primary text-white":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),whileTap:{scale:.95},children:(0,s.jsx)(d.A,{className:"w-4 h-4"})}),(0,s.jsx)(n.P.button,{onClick:()=>C("line"),className:"p-2 rounded-md transition-colors duration-200 ".concat("line"===k?"bg-destock-primary text-white":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),whileTap:{scale:.95},children:(0,s.jsx)(m.A,{className:"w-4 h-4"})})]})]}),g&&(0,s.jsx)("div",{className:"flex space-x-1",children:["1H","4H","1D","1W","1M"].map(e=>(0,s.jsx)(n.P.button,{onClick:()=>D(e),className:"px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 ".concat(N===e?"bg-destock-primary text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"),whileTap:{scale:.95},children:e},e))})]}),(0,s.jsxs)("div",{className:"relative",children:[S&&(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:(0,s.jsx)(x.k,{})}),(0,s.jsx)(n.P.div,{ref:b,className:"".concat(S?"opacity-30":"opacity-100"," transition-opacity duration-200"),initial:{opacity:0,scale:.95},animate:{opacity:S?.3:1,scale:1},transition:{duration:.3},style:{height:"".concat(u,"px")}})]}),(0,s.jsx)("div",{className:"p-4 border-t border-white/10 dark:border-black/10",children:(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Open"}),(0,s.jsxs)("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:["$",E.length>0?E[E.length-1].open.toFixed(2):"0.00"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"High"}),(0,s.jsxs)("span",{className:"font-medium text-success",children:["$",E.length>0?E[E.length-1].high.toFixed(2):"0.00"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Low"}),(0,s.jsxs)("span",{className:"font-medium text-danger",children:["$",E.length>0?E[E.length-1].low.toFixed(2):"0.00"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Volume"}),(0,s.jsx)("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:E.length>0?(E[E.length-1].volume||0).toLocaleString():"0"})]})]})})]})}},53553:(e,a,t)=>{Promise.resolve().then(t.bind(t,77917))},77917:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>A});var s=t(54568),r=t(7620),i=t(81636),n=t(52083),l=t(49645),c=t(26330),o=t(24508),d=t(61855),m=t(12463),x=t(32987),h=t(39818);function u(e){let{title:a,id:t,children:n,className:u="",isCollapsed:g=!1,isLoading:p=!1,error:y,onToggle:b,onClose:f,onSettings:v,showControls:j=!0,draggable:N=!0,resizable:w=!0,size:k="medium"}=e,[C,S]=(0,r.useState)(!1),P=(e,a)=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),a())};return(0,s.jsxs)(i.P.div,{className:(0,x.$)("glass-card widget-enter",{small:"min-h-[200px]",medium:"min-h-[300px]",large:"min-h-[400px]",full:"h-full"}[k],u),onMouseEnter:()=>S(!0),onMouseLeave:()=>S(!1),layout:!0,initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{type:"spring",stiffness:300,damping:20},role:"region","aria-labelledby":"widget-".concat(t,"-title"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-white/10 dark:border-black/10",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[N&&(0,s.jsx)(i.P.div,{className:"cursor-grab text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(c.A,{className:"w-4 h-4"})}),(0,s.jsx)("h3",{id:"widget-".concat(t,"-title"),className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a})]}),j&&(0,s.jsx)(l.N,{children:(C||g)&&(0,s.jsxs)(i.P.div,{className:"flex items-center space-x-1",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2},children:[v&&(0,s.jsx)(i.P.button,{onClick:v,onKeyDown:e=>P(e,v),className:"p-1 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-white/10 dark:hover:bg-black/10 transition-colors duration-200",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"Settings for ".concat(a),children:(0,s.jsx)(o.A,{className:"w-4 h-4"})}),b&&(0,s.jsx)(i.P.button,{onClick:b,onKeyDown:e=>P(e,b),className:"p-1 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-white/10 dark:hover:bg-black/10 transition-colors duration-200",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":g?"Expand ".concat(a):"Collapse ".concat(a),children:(0,s.jsx)(d.A,{className:"w-4 h-4"})}),f&&(0,s.jsx)(i.P.button,{onClick:f,onKeyDown:e=>P(e,f),className:"p-1 rounded-md text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors duration-200",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"Close ".concat(a),children:(0,s.jsx)(m.A,{className:"w-4 h-4"})})]})})]}),(0,s.jsx)(l.N,{mode:"wait",children:!g&&(0,s.jsx)(i.P.div,{className:"p-4 h-full overflow-auto custom-scrollbar",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},children:y?(0,s.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-red-500 dark:text-red-400 text-sm font-medium mb-2",children:"Error loading widget"}),(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:y})]})}):p?(0,s.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,s.jsx)(h.k,{})}):n})}),w&&!g&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 w-4 h-4 cursor-se-resize opacity-0 hover:opacity-100 transition-opacity duration-200",children:(0,s.jsx)("div",{className:"w-full h-full bg-gray-400 dark:bg-gray-600 transform rotate-45 translate-x-2 translate-y-2"})})]})}function g(e){let{widgets:a,layout:t="grid",className:l=""}=e,[c,o]=(0,r.useState)(!1),[d,m]=(0,r.useState)(0),[x,h]=(0,r.useState)(new Set);(0,r.useEffect)(()=>{let e=()=>{o(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let g=e=>{let a=new Set(x);a.has(e)?a.delete(e):a.add(e),h(a)};return c||"tabs"===t?(0,s.jsxs)("div",{className:"space-y-4 ".concat(l),children:[(0,s.jsx)("div",{className:"flex space-x-1 glass-card p-1 rounded-lg",children:a.map((e,a)=>(0,s.jsx)(i.P.button,{onClick:()=>m(a),className:"flex-1 px-3 py-2 text-sm font-medium rounded-md transition-all duration-200 ".concat(d===a?"bg-destock-primary text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),whileTap:{scale:.98},children:e.title},e.id))}),(0,s.jsx)(i.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},children:(0,s.jsx)(u,{title:a[d].title,id:a[d].id,onToggle:()=>g(a[d].id),isCollapsed:x.has(a[d].id),showControls:!1,children:a[d].component})},d)]}):(0,s.jsx)(i.P.div,{className:"h-[calc(100vh-200px)] ".concat(l),initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:(0,s.jsx)(n.YZ,{direction:"horizontal",className:"space-x-4",children:a.map((e,t)=>(0,s.jsxs)(n.Zk,{defaultSize:e.defaultSize||50,minSize:e.minSize||20,collapsible:e.collapsible,children:[(0,s.jsx)(i.P.div,{className:"h-full",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1*t,duration:.3},children:(0,s.jsx)(u,{title:e.title,id:e.id,onToggle:()=>g(e.id),isCollapsed:x.has(e.id),className:"h-full",children:!x.has(e.id)&&e.component})}),t<a.length-1&&(0,s.jsx)(n.TW,{className:"w-4 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-1 h-8 bg-gray-300 dark:bg-gray-600 rounded-full hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors duration-200"})})]},e.id))})})}var p=t(2042),y=t(36543),b=t(33055),f=t(62942),v=t(27261),j=t.n(v),N=t(28521);function w(){let{isConnected:e}=(0,b.F)(),{nextCompanyId:a,getCompany:t,getSharePrice:n}=(0,y.P)(),l=(0,f.useRouter)(),[c,o]=(0,r.useState)([]),[d,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(""),[u,g]=(0,r.useState)("marketCap"),[p,v]=(0,r.useState)("desc"),[w,k]=(0,r.useState)("");(0,r.useEffect)(()=>{C()},[]);let C=async()=>{m(!0);try{let e=await fetch("/api/market?type=companies"),a=await e.json();o(a.companies||[])}catch(t){console.error("Failed to load companies:",t),e&&a>0&&await S()}finally{m(!1)}},S=async()=>{let e=[];for(let t=0;t<a;t++)e.push(P(t));o((await Promise.all(e)).filter(Boolean))},P=async e=>{try{return{id:e,name:"Company ".concat(e+1),owner:"0x1234567890123456789012345678901234567890",initialPrice:"10.0",totalSupply:"1000",currentPrice:"12.5"}}catch(a){return console.error("Failed to load company ".concat(e,":"),a),null}},E=e=>{u===e?v("asc"===p?"desc":"asc"):(g(e),v("desc"))},M=c.filter(e=>{let a=e.name.toLowerCase().includes(x.toLowerCase())||e.symbol&&e.symbol.toLowerCase().includes(x.toLowerCase()),t=!w||e.sector===w;return a&&t}).sort((e,a)=>{let t,s;switch(u){case"name":t=e.name,s=a.name;break;case"currentPrice":t=parseFloat(e.currentPrice||"0"),s=parseFloat(a.currentPrice||"0");break;case"change":t=e.change||0,s=a.change||0;break;case"volume":t=e.volume||0,s=a.volume||0;break;case"marketCap":t=e.marketCap||0,s=a.marketCap||0;break;default:return 0}return"string"==typeof t?"asc"===p?t.localeCompare(s):s.localeCompare(t):"asc"===p?t-s:s-t}),A=Array.from(new Set(c.map(e=>e.sector).filter(Boolean))),D=e=>"".concat(e.slice(0,6),"...").concat(e.slice(-4)),F=e=>e>=1e9?"".concat((e/1e9).toFixed(1),"B"):e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toString();return e?d?(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((e,a)=>(0,s.jsx)("div",{className:"destock-card animate-pulse",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),(0,s.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})},a))}):0===c.length?(0,s.jsxs)("div",{className:"destock-card text-center py-8",children:[(0,s.jsx)(N.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Companies Listed"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Be the first to register your company on DeStock!"}),(0,s.jsx)(j(),{href:"/register",className:"destock-button-primary inline-flex items-center",children:"Register Company"})]}):(0,s.jsxs)(i.P.div,{className:"glass-card p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-6 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Market Overview"}),(0,s.jsx)(i.P.div,{className:"mb-6 space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search companies or symbols...",value:x,onChange:e=>h(e.target.value),className:"w-full p-3 pl-10 rounded-xl bg-gray-800/50 border border-gray-700/50    text-white placeholder-gray-400 focus:outline-none focus:ring-2    focus:ring-blue-500/50 transition-all duration-200"}),(0,s.jsx)("svg",{className:"absolute left-3 top-3 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,s.jsxs)("select",{value:w,onChange:e=>k(e.target.value),className:"p-3 rounded-xl bg-gray-800/50 border border-gray-700/50 text-white    focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all duration-200",children:[(0,s.jsx)("option",{value:"",children:"All Sectors"}),A.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]})}),(0,s.jsx)(i.P.div,{className:"overflow-x-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-700/50",children:[[{key:"name",label:"Company"},{key:"currentPrice",label:"Price"},{key:"change",label:"Change (24h)"},{key:"volume",label:"Volume"},{key:"marketCap",label:"Market Cap"}].map(e=>{let{key:a,label:t}=e;return(0,s.jsx)("th",{className:"text-left py-4 px-4 text-gray-300 font-medium cursor-pointer    hover:text-white transition-colors duration-200",onClick:()=>E(a),children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("span",{children:t}),u===a&&(0,s.jsx)("svg",{className:"w-4 h-4 transition-transform duration-200 ".concat("desc"===p?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})]})},a)}),(0,s.jsx)("th",{className:"text-left py-4 px-4 text-gray-300 font-medium",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:M.map((e,a)=>{var t;let r=(e.change||0)>=0?"text-green-400":"text-red-400",n=(e.change||0)>=0?"+":"";return(0,s.jsxs)(i.P.tr,{className:"border-b border-gray-800/30 hover:bg-gray-800/20 transition-colors duration-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*a},whileHover:{scale:1.01},children:[(0,s.jsx)("td",{className:"py-4 px-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-500    flex items-center justify-center text-white font-bold",children:e.symbol?e.symbol.charAt(0):e.name.charAt(0)}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-semibold text-white",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:e.symbol||D(e.id.toString())})]})]})}),(0,s.jsx)("td",{className:"py-4 px-4",children:(0,s.jsxs)("div",{className:"font-semibold text-white",children:[e.currentPrice," DSTK"]})}),(0,s.jsxs)("td",{className:"py-4 px-4 font-semibold ".concat(r),children:[n,(null==(t=e.change)?void 0:t.toFixed(2))||"0.00","%"]}),(0,s.jsx)("td",{className:"py-4 px-4 text-gray-300",children:F(e.volume||0)}),(0,s.jsxs)("td",{className:"py-4 px-4 text-gray-300",children:[F(e.marketCap||0)," DSTK"]}),(0,s.jsx)("td",{className:"py-4 px-4",children:(0,s.jsx)(i.P.button,{onClick:()=>l.push("/company/".concat(e.id)),className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600    hover:from-blue-700 hover:to-purple-700 rounded-lg    transition-all duration-200 text-sm font-medium text-white",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Trade"})})]},e.id)})})]})}),0===M.length&&(0,s.jsxs)(i.P.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 text-gray-400",children:[(0,s.jsx)("div",{className:"text-lg font-medium mb-2",children:"No companies found"}),(0,s.jsx)("div",{className:"text-sm",children:x?'No results for "'.concat(x,'"'):"No companies available"})]})]}):(0,s.jsxs)("div",{className:"destock-card text-center py-8",children:[(0,s.jsx)(N.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connect Your Wallet"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Connect your wallet to view listed companies."})]})}var k=t(19184);function C(e){let{className:a}=e,[t,n]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{o()},[]);let o=async()=>{try{let e=await fetch("/api/market?type=heatmap"),a=await e.json();n(a.heatmap||[])}catch(e){console.error("Failed to load heatmap data:",e),n(d())}finally{c(!1)}},d=()=>[{name:"TechCorp",symbol:"TECH"},{name:"FinanceInc",symbol:"FIN"},{name:"HealthCare Ltd",symbol:"HEAL"},{name:"Energy Solutions",symbol:"NRGY"},{name:"Retail Giant",symbol:"RTGN"},{name:"Manufacturing Co",symbol:"MANU"},{name:"Transport Hub",symbol:"TRNS"},{name:"Media Group",symbol:"MEDA"},{name:"Real Estate",symbol:"REST"},{name:"Biotech Inc",symbol:"BIOT"},{name:"Aerospace Ltd",symbol:"AERO"},{name:"Telecom Corp",symbol:"TCOM"}].map((e,a)=>({id:a.toString(),name:e.name,symbol:e.symbol,value:1e3*Math.random()+100,change:(Math.random()-.5)*20,size:80*Math.random()+40})),m=e=>e>5?"from-green-500 to-green-600":e>2?"from-green-400 to-green-500":e>0?"from-green-300 to-green-400":e>-2?"from-red-300 to-red-400":e>-5?"from-red-400 to-red-500":"from-red-500 to-red-600",x=e=>Math.abs(e)>3?"text-white":"text-gray-800";return l?(0,s.jsxs)("div",{className:"glass-card p-6 ".concat(a),children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Market Heat Map"}),(0,s.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:[...Array(12)].map((e,a)=>(0,s.jsx)("div",{className:"aspect-square rounded-lg bg-gray-700/30 animate-pulse"},a))})]}):(0,s.jsxs)(i.P.div,{className:"glass-card p-6 ".concat(a),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[(0,s.jsx)("h3",{className:"text-xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:"Market Heat Map"}),(0,s.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-2",children:t.map((e,a)=>(0,s.jsxs)(i.P.div,{className:"\n              aspect-square rounded-lg p-2 cursor-pointer\n              bg-gradient-to-br ".concat(m(e.change),"\n              hover:scale-105 transition-all duration-200\n              flex flex-col justify-between\n              ").concat(x(e.change),"\n            "),style:{minHeight:"".concat(Math.max(e.size,60),"px"),opacity:.8+Math.abs(e.change)/20*.2},initial:{opacity:0,scale:.8},animate:{opacity:.8+Math.abs(e.change)/20*.2,scale:1},transition:{duration:.3,delay:.05*a},whileHover:{scale:1.05,opacity:1,transition:{duration:.2}},title:"".concat(e.name," (").concat(e.symbol,"): ").concat(e.change>0?"+":"").concat(e.change.toFixed(2),"%"),children:[(0,s.jsx)("div",{className:"text-xs font-semibold truncate",children:e.symbol}),(0,s.jsxs)("div",{className:"text-xs font-bold",children:[e.change>0?"+":"",e.change.toFixed(1),"%"]})]},e.id))}),(0,s.jsxs)("div",{className:"mt-4 flex items-center justify-between text-xs text-gray-400",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-gradient-to-r from-green-400 to-green-500"}),(0,s.jsx)("span",{children:"Positive"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-gradient-to-r from-red-400 to-red-500"}),(0,s.jsx)("span",{children:"Negative"})]})]}),(0,s.jsx)("div",{className:"text-xs",children:"Size = Market Cap | Color = 24h Change"})]})]})}var S=t(66734),P=t(22935),E=t(25582);function M(e){let{speed:a=50,direction:t="left",className:n="",pauseOnHover:l=!0}=e,[c,o]=(0,r.useState)([]),[d,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/market?type=ticker"),a=await e.json();o(a.ticker||[])}catch(e){console.error("Failed to fetch ticker data:",e),o([{symbol:"AAPL",name:"Apple Inc.",price:182.52,change:2.34,changePercent:1.3,volume:0x2b23987},{symbol:"MSFT",name:"Microsoft",price:378.91,change:-1.23,changePercent:-.32,volume:0x165ec15},{symbol:"GOOGL",name:"Alphabet",price:142.65,change:3.45,changePercent:2.5,volume:0x20f76d2}])}finally{h(!1)}};e();let a=setInterval(e,3e4);return()=>clearInterval(a)},[]),(0,r.useEffect)(()=>{if(0===c.length)return;let e=setInterval(()=>{o(e=>e.map(e=>{let a=(Math.random()-.5)*.5,t=e.price*(1+a/100),s=t-e.price;return{...e,price:Number(t.toFixed(2)),change:Number(s.toFixed(2)),changePercent:Number((s/e.price*100).toFixed(2))}}))},5e3);return()=>clearInterval(e)},[c.length]),x)?(0,s.jsx)("div",{className:"glass-card h-16 flex items-center justify-center ".concat(n),children:(0,s.jsx)("div",{className:"flex space-x-4",children:Array.from({length:5}).map((e,a)=>(0,s.jsxs)("div",{className:"flex space-x-2 animate-pulse",children:[(0,s.jsx)("div",{className:"w-12 h-4 bg-gray-300 dark:bg-gray-600 rounded"}),(0,s.jsx)("div",{className:"w-16 h-4 bg-gray-300 dark:bg-gray-600 rounded"}),(0,s.jsx)("div",{className:"w-12 h-4 bg-gray-300 dark:bg-gray-600 rounded"})]},a))})}):(0,s.jsxs)("div",{className:"glass-card overflow-hidden relative ".concat(n),onMouseEnter:()=>l&&m(!0),onMouseLeave:()=>l&&m(!1),children:[(0,s.jsx)("div",{className:"h-16 flex items-center",children:(0,s.jsx)(i.P.div,{className:"flex space-x-8 whitespace-nowrap",animate:{x:"left"===t?"-50%":"50%"},transition:{duration:a,repeat:1/0,ease:"linear"},style:{animationPlayState:d?"paused":"running"},children:[...c,...c].map((e,a)=>(0,s.jsxs)(i.P.div,{className:"flex items-center space-x-3 min-w-fit",whileHover:l?{scale:1.05}:{},children:[(0,s.jsx)("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:e.symbol}),(0,s.jsx)(E.q,{value:e.price,format:"currency",decimals:2,className:"font-medium text-gray-900 dark:text-gray-100"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 ".concat(e.change>=0?"text-success":"text-danger"),children:[e.change>=0?(0,s.jsx)(S.A,{className:"w-3 h-3"}):(0,s.jsx)(P.A,{className:"w-3 h-3"}),(0,s.jsxs)("span",{className:"text-sm font-medium",children:[e.change>=0?"+":"",e.change.toFixed(2)]}),(0,s.jsxs)("span",{className:"text-sm",children:["(",e.changePercent>=0?"+":"",e.changePercent.toFixed(2),"%)"]})]}),(0,s.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Vol: ",(e.volume/1e6).toFixed(1),"M"]})]},"".concat(e.symbol,"-").concat(a)))})}),(0,s.jsx)("div",{className:"absolute left-0 top-0 w-12 h-full bg-gradient-to-r from-white/80 dark:from-gray-900/80 to-transparent pointer-events-none"}),(0,s.jsx)("div",{className:"absolute right-0 top-0 w-12 h-full bg-gradient-to-l from-white/80 dark:from-gray-900/80 to-transparent pointer-events-none"})]})}function A(){let e=(0,r.useMemo)(()=>[{id:"trading",title:"Trading Interface",component:(0,s.jsx)(p.s,{}),defaultSize:40,minSize:30},{id:"chart",title:"Price Chart",component:(0,s.jsx)(k.k,{symbol:"DSTK",height:350}),defaultSize:60,minSize:40}],[]),a=(0,r.useMemo)(()=>[{id:"companies",title:"Market Overview",component:(0,s.jsx)(w,{}),defaultSize:60,minSize:50},{id:"heatmap",title:"Market Heat Map",component:(0,s.jsx)(C,{}),defaultSize:40,minSize:30}],[]);return(0,s.jsxs)(i.P.div,{className:"space-y-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,s.jsxs)(i.P.div,{className:"text-center glass-card p-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Welcome to DeStock"}),(0,s.jsx)("p",{className:"text-xl text-gray-600 dark:text-gray-400 max-w-4xl mx-auto",children:"The professional decentralized trading platform with advanced charting, real-time analytics, and seamless Web3 integration. Trade company shares using DSTK tokens with institutional-grade tools."})]}),(0,s.jsx)(i.P.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:.2,duration:.5},children:(0,s.jsx)(M,{})}),(0,s.jsx)(i.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.3,duration:.5},children:(0,s.jsx)(g,{widgets:e})}),(0,s.jsx)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},children:(0,s.jsx)(g,{widgets:a,layout:"grid"})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[850,319,599,978,923,72,823,888,42,587,315,358],()=>a(53553)),_N_E=e.O()}]);