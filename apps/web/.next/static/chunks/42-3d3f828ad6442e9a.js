"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[42],{2042:(e,a,s)=>{s.d(a,{s:()=>N});var t=s(54568),i=s(7620),n=s(61938),c=s(90060),r=s(68072),l=s(81636),d=s(49645),o=s(36543),m=s(66888),x=s(33055),u=s(72730),p=s(66734),y=s(22935),h=s(54876),f=s(3367),g=s(25582),j=s(39818);let b=r.Ik({companyId:r.Yj().min(1,"Please select a company"),amount:r.Yj().min(1,"Amount is required")});function N(){let{isConnected:e}=(0,x.F)(),{buyShares:a,sellShares:s,getSharePrice:r,getShareBalance:N,nextCompanyId:v,isPending:w,isConfirming:k,isConfirmed:S,error:P}=(0,o.P)(),{balance:F}=(0,m.O)(),[I,B]=(0,i.useState)([]),[C,T]=(0,i.useState)(null),[A,D]=(0,i.useState)("buy"),[$,q]=(0,i.useState)("0"),[K,E]=(0,i.useState)(!1),{register:Y,handleSubmit:z,formState:{errors:O},watch:Q,setValue:_,reset:H}=(0,n.mN)({resolver:(0,c.u)(b)}),L=Q("companyId"),M=Q("amount");(0,i.useEffect)(()=>{e&&v>0&&U()},[e,v]),(0,i.useEffect)(()=>{if(L){let e=I.find(e=>e.id.toString()===L);e&&(T(e),G(e.id))}},[L,I]);let U=async()=>{try{let e=[];for(let a=0;a<v;a++)e.push({id:a,name:"Company ".concat(a+1),price:"12.5"});B(e)}catch(e){console.error("Failed to load companies:",e)}},G=async e=>{try{q("100")}catch(e){console.error("Failed to load user shares:",e),q("0")}},R=()=>C&&M?(parseFloat(C.price)*parseFloat(M)).toFixed(2):"0",W=async e=>{if(C){E(!0);try{"buy"===A?await a(C.id,e.amount):await s(C.id,e.amount),H()}catch(e){console.error("Trade failed:",e)}finally{E(!1)}}},Z=()=>{if(!C||!M)return!1;let e=parseFloat(M);if(e<=0)return!1;if("buy"!==A)return parseFloat($)>=e;{let e=parseFloat(R());return parseFloat(F)>=e}};return e?(0,t.jsxs)(l.P.div,{className:"glass-card p-6 widget-enter",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)(l.P.h3,{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:"Trade Shares"}),(0,t.jsxs)(l.P.div,{className:"flex glass-button rounded-lg p-1",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1},children:[(0,t.jsx)(l.P.button,{onClick:()=>D("buy"),className:"px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ".concat("buy"===A?"bg-success text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),whileTap:{scale:.95},children:(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(p.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Buy"})]})}),(0,t.jsx)(l.P.button,{onClick:()=>D("sell"),className:"px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 ".concat("sell"===A?"bg-danger text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),whileTap:{scale:.95},children:(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(y.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Sell"})]})})]})]}),(0,t.jsxs)(l.P.form,{onSubmit:z(W),className:"space-y-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:[(0,t.jsxs)(l.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"companyId",children:"Select Company"}),(0,t.jsxs)("select",{...Y("companyId"),id:"companyId",className:"destock-input",children:[(0,t.jsx)("option",{value:"",children:"Choose a company"}),I.map(e=>(0,t.jsxs)("option",{value:e.id.toString(),children:[e.name," - ",e.price," DSTK"]},e.id))]}),(0,t.jsx)(d.N,{children:O.companyId&&(0,t.jsxs)(l.P.p,{className:"mt-1 text-sm text-danger flex items-center space-x-1",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[(0,t.jsx)(h.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:O.companyId.message})]})})]}),(0,t.jsx)(d.N,{children:C&&(0,t.jsxs)(l.P.div,{className:"glass-card p-4",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},transition:{type:"spring",stiffness:300,damping:25},children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:C.name}),(0,t.jsx)(l.P.span,{className:"text-lg font-bold text-destock-primary",initial:{scale:1.2,color:"#10B981"},animate:{scale:1,color:"#3B82F6"},transition:{duration:.3},children:(0,t.jsx)(g.q,{value:parseFloat(C.price),suffix:" DSTK",decimals:2})},C.price)]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center justify-between",children:[(0,t.jsx)("span",{children:"Your Holdings:"}),(0,t.jsx)(g.q,{value:parseFloat($),suffix:" shares",decimals:0,className:"font-medium"})]})]})}),(0,t.jsxs)(l.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},children:[(0,t.jsx)("label",{className:"destock-label",htmlFor:"amount",children:"Amount"}),(0,t.jsx)("input",{...Y("amount"),type:"number",step:"1",min:"1",id:"amount",className:"destock-input",placeholder:"Number of shares"}),(0,t.jsx)(d.N,{children:O.amount&&(0,t.jsxs)(l.P.p,{className:"mt-1 text-sm text-danger flex items-center space-x-1",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[(0,t.jsx)(h.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:O.amount.message})]})})]}),(0,t.jsx)(d.N,{children:C&&M&&(0,t.jsxs)(l.P.div,{className:"glass-card p-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{type:"spring",stiffness:300,damping:25},children:[(0,t.jsxs)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center space-x-2",children:[(0,t.jsx)(f.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Transaction Summary"})]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Shares:"}),(0,t.jsx)("span",{className:"font-medium",children:M})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Price per share:"}),(0,t.jsxs)("span",{className:"font-medium",children:[C.price," DSTK"]})]}),(0,t.jsxs)("div",{className:"flex justify-between font-semibold border-t border-white/10 dark:border-black/10 pt-2 text-gray-900 dark:text-gray-100",children:[(0,t.jsxs)("span",{children:["Total ","buy"===A?"Cost":"Proceeds",":"]}),(0,t.jsx)(g.q,{value:parseFloat(R()),suffix:" DSTK",decimals:2,className:"buy"===A?"text-danger":"text-success"})]})]}),"buy"===A&&(0,t.jsxs)("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400 flex items-center justify-between",children:[(0,t.jsx)("span",{children:"Your DSTK Balance:"}),(0,t.jsx)(g.q,{value:parseFloat(F||"0"),suffix:" DSTK",decimals:2,className:"font-medium"})]})]})}),(0,t.jsx)(d.N,{children:P&&(0,t.jsx)(l.P.div,{className:"glass-card p-4 border border-danger/30 bg-danger/10",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},children:(0,t.jsxs)("p",{className:"text-sm text-danger flex items-center space-x-2",children:[(0,t.jsx)(h.A,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:["Transaction failed: ",P.message]})]})})}),(0,t.jsxs)(l.P.button,{type:"submit",disabled:!Z()||w||k||K,className:"w-full flex items-center justify-center space-x-2 py-3 px-4 rounded-md font-semibold transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed ".concat("buy"===A?"bg-success hover:bg-success/80 text-white shadow-lg":"bg-danger hover:bg-danger/80 text-white shadow-lg"),whileHover:{scale:1.02},whileTap:{scale:.98},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[w||k||K?(0,t.jsx)(j.k,{size:"small"}):"buy"===A?(0,t.jsx)(p.A,{className:"w-5 h-5"}):(0,t.jsx)(y.A,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:w||k||K?"Processing...":Z()?"".concat("buy"===A?"Buy":"Sell"," Shares"):"buy"===A?"Insufficient Balance":"Insufficient Shares"})]}),(0,t.jsx)(d.N,{children:S&&(0,t.jsx)(l.P.div,{className:"glass-card p-4 border border-success/30 bg-success/10",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},transition:{type:"spring",stiffness:300,damping:25},children:(0,t.jsxs)("p",{className:"text-sm text-success flex items-center space-x-2",children:[(0,t.jsx)(p.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Transaction completed successfully! \uD83C\uDF89"})]})})})]})]}):(0,t.jsxs)("div",{className:"trading-card text-center",children:[(0,t.jsx)(u.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connect Your Wallet"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Connect your wallet to start trading shares."})]})}},25582:(e,a,s)=>{s.d(a,{q:()=>l});var t=s(54568),i=s(7620),n=s(57551),c=s(28558),r=s(81636);function l(e){let{value:a,format:s="decimal",decimals:l=2,prefix:d="",suffix:o="",duration:m=.5,className:x="",colorChange:u=!1,previousValue:p}=e,[y,h]=(0,i.useState)(a),[f,g]=(0,i.useState)(!1),j=(0,n.z)(a,{stiffness:100,damping:15}),b=(0,c.G)(j,e=>{let a;switch(s){case"currency":a=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:l,maximumFractionDigits:l}).format(e);break;case"percentage":a="".concat(e.toFixed(l),"%");break;case"integer":a=Math.round(e).toLocaleString();break;default:a=e.toFixed(l)}return"".concat(d).concat(a).concat(o)});return(0,i.useEffect)(()=>{if(a!==y){g(!0),j.set(a),h(a);let e=setTimeout(()=>{g(!1)},1e3*m);return()=>clearTimeout(e)}},[a,y,j,m]),(0,t.jsx)(r.P.span,{className:"number-counter ".concat(!u||void 0===p?"":a>p?"text-success":a<p?"text-danger":""," ").concat(x),animate:f?{scale:[1,1.05,1]}:{},transition:{type:"tween",duration:.3,ease:"easeInOut"},"aria-live":"polite",children:b})}},36543:(e,a,s)=>{s.d(a,{P:()=>o});var t=s(33055),i=s(441),n=s(34072),c=s(54953),r=s(14532),l=s(7620),d=s(53995);function o(){let{address:e,chainId:a}=(0,t.F)(),s=(0,l.useMemo)(()=>{if(a)return(0,r.RZ)("DESTOCK",a)},[a]),{writeContract:o,data:m,error:x,isPending:u}=(0,i.x)(),{isLoading:p,isSuccess:y}=(0,n.g)({hash:m}),{data:h}=(0,c.Q)({address:s,abi:r.$B,functionName:"nextCompanyId"}),f=(0,l.useCallback)(e=>(0,c.Q)({address:s,abi:r.$B,functionName:"companies",args:[BigInt(e)]}),[s]),g=(0,l.useCallback)(e=>(0,c.Q)({address:s,abi:r.$B,functionName:"getSharePrice",args:[BigInt(e)]}),[s]),j=(0,l.useCallback)((a,t)=>{let i=t||e;return(0,c.Q)({address:s,abi:r.$B,functionName:"balanceOf",args:i?[i,BigInt(a)]:void 0,query:{enabled:!!i}})},[s,e]),b=(0,l.useCallback)((e,a,t)=>{s&&o({address:s,abi:r.$B,functionName:"registerCompany",args:[e,(0,d.g)(a),BigInt(t)]})},[s,o]),N=(0,l.useCallback)((e,a)=>{s&&o({address:s,abi:r.$B,functionName:"buyShares",args:[BigInt(e),BigInt(a)]})},[s,o]),v=(0,l.useCallback)((e,a)=>{s&&o({address:s,abi:r.$B,functionName:"sellShares",args:[BigInt(e),BigInt(a)]})},[s,o]);return{contractAddress:s,nextCompanyId:h?Number(h):0,getCompany:f,getSharePrice:g,getShareBalance:j,registerCompany:b,buyShares:N,sellShares:v,hash:m,isPending:u,isConfirming:p,isConfirmed:y,error:x}}},39818:(e,a,s)=>{s.d(a,{k:()=>c});var t=s(54568),i=s(81636),n=s(32987);function c(e){let{size:a="medium",variant:s="circular",className:c="",overlay:r=!1}=e;return"circular"===s?(0,t.jsx)("div",{className:(0,n.$)("flex items-center justify-center",r&&"fixed inset-0 glass-modal z-50",c),children:(0,t.jsx)(i.P.div,{className:(0,n.$)("border-2 border-destock-primary/20 border-t-destock-primary rounded-full",{small:"w-4 h-4",medium:"w-8 h-8",large:"w-12 h-12"}[a]),animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}):"dots"===s?(0,t.jsx)("div",{className:(0,n.$)("flex items-center justify-center space-x-1",r&&"fixed inset-0 glass-modal z-50",c),children:[0,1,2].map(e=>(0,t.jsx)(i.P.div,{className:"w-2 h-2 bg-destock-primary rounded-full",animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:.2*e}},e))}):"bars"===s?(0,t.jsx)("div",{className:(0,n.$)("flex items-center justify-center space-x-1",r&&"fixed inset-0 glass-modal z-50",c),children:[0,1,2,3].map(e=>(0,t.jsx)(i.P.div,{className:"w-1 bg-destock-primary rounded-full",style:{height:"small"===a?16:"medium"===a?24:32},animate:{scaleY:[1,2,1]},transition:{duration:1,repeat:1/0,delay:.1*e}},e))}):null}}}]);