"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[852],{19184:(e,a,t)=>{t.d(a,{k:()=>x});var r=t(54568),s=t(7620),n=t(63557),i=t(81636),l=t(21752),c=t(66734),d=t(22935),o=t(35551),u=t(7886),g=t(39818);let m=[];function x(e){let{symbol:a="DEMO",data:t=m,height:x=400,showTimeframes:h=!0,showIndicators:b=!0,className:f=""}=e,p=(0,s.useRef)(null),y=(0,s.useRef)(null),k=(0,s.useRef)(null),N=(0,s.useRef)(m),[j,v]=(0,s.useState)("1D"),[B,C]=(0,s.useState)("candlestick"),[w,D]=(0,s.useState)(!0),[I,$]=(0,s.useState)([]),{theme:E}=(0,l.D)();(0,s.useEffect)(()=>{if(!p.current)return;let e="dark"===E,a=(0,n.R9)(p.current,{width:p.current.clientWidth,height:x,layout:{background:{type:n.mE.Solid,color:"transparent"},textColor:e?"#E5E7EB":"#374151"},grid:{vertLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},horzLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},crosshair:{mode:1},timeScale:{borderColor:e?"#374151":"#D1D5DB",timeVisible:!0,secondsVisible:!1},rightPriceScale:{borderColor:e?"#374151":"#D1D5DB"}}),t=a.addCandlestickSeries({upColor:"#00D4AA",downColor:"#F6465D",borderDownColor:"#F6465D",borderUpColor:"#00D4AA",wickDownColor:"#F6465D",wickUpColor:"#00D4AA"});y.current=a,k.current=t;let r=()=>{p.current&&y.current&&y.current.applyOptions({width:p.current.clientWidth})};return window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r),y.current&&(y.current.remove(),y.current=null,k.current=null)}},[x,E]),(0,s.useEffect)(()=>{if(!y.current)return;let e="dark"===E;y.current.applyOptions({layout:{background:{type:n.mE.Solid,color:"transparent"},textColor:e?"#E5E7EB":"#374151"},grid:{vertLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"},horzLines:{color:e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"}},timeScale:{borderColor:e?"#374151":"#D1D5DB"},rightPriceScale:{borderColor:e?"#374151":"#D1D5DB"}})},[E]),(0,s.useEffect)(()=>{t!==N.current&&t.length>0&&t!==m&&(console.log("TradingChart: Using provided data",t.length,"points"),N.current=t,$(t),D(!1))},[t]),(0,s.useEffect)(()=>{(async()=>{if(!(t.length>0)||t===m){console.log("TradingChart: Loading data from API",{symbol:a,selectedTimeframe:j}),D(!0);try{let e=await fetch("/api/market?type=chart&symbol=".concat(a,"&timeframe=").concat(j,"&days=30")),t=await e.json();if(e.ok&&t.data&&t.data.ohlc){let e=(t.data.ohlc||[]).map(e=>({...e,time:e.time}));console.log("TradingChart: API data loaded",e.length,"points"),$(e)}else console.warn("Failed to fetch chart data:",t),$([]);D(!1)}catch(e){console.error("Failed to load chart data:",e),$([]),D(!1)}}})()},[a,j]),(0,s.useEffect)(()=>{k.current&&0!==I.length&&(k.current.setData(I),y.current&&y.current.timeScale().fitContent())},[I]);let S=e=>{v(e)},P=I.length>0?I[I.length-1].close:0,L=I.length>1?I[I.length-2].close:P,A=P-L,F=L>0?A/L*100:0,O=A>=0;return(0,r.jsxs)("div",{className:"glass-card ".concat(f),children:[(0,r.jsxs)("div",{className:"p-4 border-b border-white/10 dark:border-black/10",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("span",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["$",P.toFixed(2)]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 ".concat(O?"text-success":"text-danger"),children:[O?(0,r.jsx)(c.A,{className:"w-4 h-4"}):(0,r.jsx)(d.A,{className:"w-4 h-4"}),(0,r.jsxs)("span",{className:"font-medium",children:[O?"+":"",A.toFixed(2)," (",F.toFixed(2),"%)"]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(i.P.button,{onClick:()=>C("candlestick"),className:"p-2 rounded-md transition-colors duration-200 ".concat("candlestick"===B?"bg-destock-primary text-white":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),whileTap:{scale:.95},children:(0,r.jsx)(o.A,{className:"w-4 h-4"})}),(0,r.jsx)(i.P.button,{onClick:()=>C("line"),className:"p-2 rounded-md transition-colors duration-200 ".concat("line"===B?"bg-destock-primary text-white":"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300"),whileTap:{scale:.95},children:(0,r.jsx)(u.A,{className:"w-4 h-4"})})]})]}),h&&(0,r.jsx)("div",{className:"flex space-x-1",children:["1H","4H","1D","1W","1M"].map(e=>(0,r.jsx)(i.P.button,{onClick:()=>S(e),className:"px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 ".concat(j===e?"bg-destock-primary text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"),whileTap:{scale:.95},children:e},e))})]}),(0,r.jsxs)("div",{className:"relative",children:[w&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:(0,r.jsx)(g.k,{})}),(0,r.jsx)(i.P.div,{ref:p,className:"".concat(w?"opacity-30":"opacity-100"," transition-opacity duration-200"),initial:{opacity:0,scale:.95},animate:{opacity:w?.3:1,scale:1},transition:{duration:.3},style:{height:"".concat(x,"px")}})]}),(0,r.jsx)("div",{className:"p-4 border-t border-white/10 dark:border-black/10",children:(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Open"}),(0,r.jsxs)("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:["$",I.length>0?I[I.length-1].open.toFixed(2):"0.00"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"High"}),(0,r.jsxs)("span",{className:"font-medium text-success",children:["$",I.length>0?I[I.length-1].high.toFixed(2):"0.00"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Low"}),(0,r.jsxs)("span",{className:"font-medium text-danger",children:["$",I.length>0?I[I.length-1].low.toFixed(2):"0.00"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 dark:text-gray-400 block",children:"Volume"}),(0,r.jsx)("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:I.length>0?(I[I.length-1].volume||0).toLocaleString():"0"})]})]})})]})}},36543:(e,a,t)=>{t.d(a,{P:()=>o});var r=t(33055),s=t(441),n=t(34072),i=t(54953),l=t(14532),c=t(7620),d=t(53995);function o(){let{address:e,chainId:a}=(0,r.F)(),t=(0,c.useMemo)(()=>{if(a)return(0,l.RZ)("DESTOCK",a)},[a]),{writeContract:o,data:u,error:g,isPending:m}=(0,s.x)(),{isLoading:x,isSuccess:h}=(0,n.g)({hash:u}),{data:b}=(0,i.Q)({address:t,abi:l.$B,functionName:"nextCompanyId"}),f=(0,c.useCallback)(e=>(0,i.Q)({address:t,abi:l.$B,functionName:"companies",args:[BigInt(e)]}),[t]),p=(0,c.useCallback)(e=>(0,i.Q)({address:t,abi:l.$B,functionName:"getSharePrice",args:[BigInt(e)]}),[t]),y=(0,c.useCallback)((a,r)=>{let s=r||e;return(0,i.Q)({address:t,abi:l.$B,functionName:"balanceOf",args:s?[s,BigInt(a)]:void 0,query:{enabled:!!s}})},[t,e]),k=(0,c.useCallback)((a,r)=>{let s=r||e;return(0,i.Q)({address:t,abi:l.$B,functionName:"getLPTokenBalance",args:s?[s,BigInt(a)]:void 0,query:{enabled:!!s}})},[t,e]),N=(0,c.useCallback)(a=>{let r=a||e;return(0,i.Q)({address:t,abi:l.$B,functionName:"getUserOrders",args:r?[r]:void 0,query:{enabled:!!r}})},[t,e]),j=(0,c.useCallback)(e=>(0,i.Q)({address:t,abi:l.$B,functionName:"getOrderDetails",args:[BigInt(e)]}),[t]),v=(0,c.useCallback)((e,a)=>(0,i.Q)({address:t,abi:l.$B,functionName:"getBuyPrice",args:[BigInt(e),BigInt(a)]}),[t]),B=(0,c.useCallback)((e,a)=>(0,i.Q)({address:t,abi:l.$B,functionName:"getSellPrice",args:[BigInt(e),BigInt(a)]}),[t]),C=(0,c.useCallback)(e=>(0,i.Q)({address:t,abi:l.$B,functionName:"getTradingVolume",args:[BigInt(e)]}),[t]),w=(0,c.useCallback)((e,a,r)=>{t&&o({address:t,abi:l.$B,functionName:"registerCompany",args:[e,(0,d.g)(a),BigInt(r)]})},[t,o]),D=(0,c.useCallback)((e,a)=>{t&&o({address:t,abi:l.$B,functionName:"buyShares",args:[BigInt(e),BigInt(a)]})},[t,o]),I=(0,c.useCallback)((e,a)=>{t&&o({address:t,abi:l.$B,functionName:"sellShares",args:[BigInt(e),BigInt(a)]})},[t,o]),$=(0,c.useCallback)((e,a,r)=>{t&&o({address:t,abi:l.$B,functionName:"addLiquidity",args:[BigInt(e),(0,d.g)(a),BigInt(r)]})},[t,o]),E=(0,c.useCallback)((e,a)=>{t&&o({address:t,abi:l.$B,functionName:"removeLiquidity",args:[BigInt(e),BigInt(a)]})},[t,o]),S=(0,c.useCallback)((e,a,r,s)=>{t&&o({address:t,abi:l.$B,functionName:"placeOrder",args:[BigInt(e),a,BigInt(r),(0,d.g)(s)]})},[t,o]),P=(0,c.useCallback)(e=>{t&&o({address:t,abi:l.$B,functionName:"cancelOrder",args:[BigInt(e)]})},[t,o]);return{contractAddress:t,nextCompanyId:b?Number(b):0,getCompany:f,getSharePrice:p,getShareBalance:y,getLPTokenBalance:k,getUserOrders:N,getOrderDetails:j,getBuyPrice:v,getSellPrice:B,getTradingVolume:C,registerCompany:w,buyShares:D,sellShares:I,addLiquidity:$,removeLiquidity:E,placeOrder:S,cancelOrder:P,hash:u,isPending:m,isConfirming:x,isConfirmed:h,error:g}}},39818:(e,a,t)=>{t.d(a,{k:()=>i});var r=t(54568),s=t(81636),n=t(32987);function i(e){let{size:a="medium",variant:t="circular",className:i="",overlay:l=!1}=e;return"circular"===t?(0,r.jsx)("div",{className:(0,n.$)("flex items-center justify-center",l&&"fixed inset-0 glass-modal z-50",i),children:(0,r.jsx)(s.P.div,{className:(0,n.$)("border-2 border-destock-primary/20 border-t-destock-primary rounded-full",{small:"w-4 h-4",medium:"w-8 h-8",large:"w-12 h-12"}[a]),animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}):"dots"===t?(0,r.jsx)("div",{className:(0,n.$)("flex items-center justify-center space-x-1",l&&"fixed inset-0 glass-modal z-50",i),children:[0,1,2].map(e=>(0,r.jsx)(s.P.div,{className:"w-2 h-2 bg-destock-primary rounded-full",animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:.2*e}},e))}):"bars"===t?(0,r.jsx)("div",{className:(0,n.$)("flex items-center justify-center space-x-1",l&&"fixed inset-0 glass-modal z-50",i),children:[0,1,2,3].map(e=>(0,r.jsx)(s.P.div,{className:"w-1 bg-destock-primary rounded-full",style:{height:"small"===a?16:"medium"===a?24:32},animate:{scaleY:[1,2,1]},transition:{duration:1,repeat:1/0,delay:.1*e}},e))}):null}}}]);