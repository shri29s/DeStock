(()=>{var e={};e.id=208,e.ids=[208],e.modules={2339:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>l,routeModule:()=>p,tree:()=>d});var r=s(24332),a=s(48819),n=s(67851),i=s.n(n),o=s(97540),c={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let d={children:["",{children:["company",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,72077)),"/home/shri/web3Hackathon/DeStock/apps/web/app/company/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,34356)),"/home/shri/web3Hackathon/DeStock/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,92341,23)),"next/dist/client/components/unauthorized-error"]}]}.children,l=["/home/shri/web3Hackathon/DeStock/apps/web/app/company/[id]/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/company/[id]/page",pathname:"/company/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},12690:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(13486),a=s(2984),n=s(77295),i=s(89250),o=s(38049),c=s(34562),d=s(60159),l=s(67201),u=s(85626),p=s(85519);function m({companyId:e}){let[t,s]=(0,d.useState)([]),[a,n]=(0,d.useState)(!0);return a?(0,r.jsx)("div",{children:"Loading trade history..."}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Trade History"}),(0,r.jsx)("ul",{className:"space-y-2",children:t.map((e,t)=>(0,r.jsxs)("li",{className:`p-2 rounded-md ${"buy"===e.type?"bg-green-100":"bg-red-100"}`,children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:e.type.toUpperCase()}),(0,r.jsx)("span",{children:new Date(e.timestamp).toLocaleString()})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{children:[e.amount," shares"]}),(0,r.jsxs)("span",{children:[(0,c.J)(BigInt(e.price),18)," DSTK"]})]}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.address})]},t))})]})}function x({companyId:e}){let[t,s]=(0,d.useState)([]),[a,n]=(0,d.useState)(!0);return a?(0,r.jsx)("div",{children:"Loading shareholders..."}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Shareholders"}),(0,r.jsx)("ul",{className:"space-y-2",children:t.map((e,t)=>(0,r.jsx)("li",{className:"p-2 rounded-md bg-gray-100",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:e.address}),(0,r.jsxs)("span",{children:[e.balance," shares"]})]})},t))})]})}let h=l.Ik({amount:l.Yj().min(1,"Amount is required")});function g(){let{id:e}=(0,a.useParams)(),t=parseInt(e),{isConnected:s,address:l}=(0,o.F)(),{getCompany:g,getSharePrice:b,getBuyPrice:y,getSellPrice:f,buyShares:j,sellShares:v}=(0,n.P)(),{balance:w,approve:N,allowance:S,isApproving:C}=(0,i.W)(),{data:P}=g(t),{data:k}=b(t),[q,B]=(0,d.useState)(),[I,A]=(0,d.useState)(),[_,D]=(0,d.useState)(!0),{register:T,handleSubmit:E,watch:K,formState:{errors:O}}=(0,u.mN)({resolver:(0,p.u)(h)});K("amount");let Q=async()=>{q&&N((0,c.J)(q,18))},$=async e=>{await j({args:[BigInt(t),BigInt(e.amount)]})},H=async e=>{await v({args:[BigInt(t),BigInt(e.amount)]})};return P?(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:P.name}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Company Details"}),(0,r.jsxs)("p",{children:["Owner: ",P.owner]}),(0,r.jsxs)("p",{children:["Total Supply: ",(0,c.J)(P.totalSupply,0)]}),(0,r.jsxs)("p",{children:["Share Price: ",k?(0,c.J)(k,18):"N/A"," DSTK"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Trade"}),(0,r.jsxs)("form",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount"}),(0,r.jsx)("input",{...T("amount"),type:"number",id:"amount",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),O.amount&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:O.amount.message})]}),q&&(0,r.jsxs)("p",{children:["Estimated Cost: ",(0,c.J)(q,18)," DSTK"]}),I&&(0,r.jsxs)("p",{children:["Estimated Proceeds: ",(0,c.J)(I,18)," DSTK"]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[_?(0,r.jsx)("button",{type:"button",onClick:Q,disabled:C,className:"w-full destock-button-secondary",children:C?"Approving...":"Approve DSTK"}):(0,r.jsx)("button",{type:"button",onClick:E($),className:"w-full destock-button-primary",children:"Buy Shares"}),(0,r.jsx)("button",{type:"button",onClick:E(H),className:"w-full destock-button-danger",children:"Sell Shares"})]})]})]})]}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(m,{companyId:t})}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(x,{companyId:t})})]}):(0,r.jsx)("div",{children:"Loading..."})}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},72077:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/shri/web3Hackathon/DeStock/apps/web/app/company/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/shri/web3Hackathon/DeStock/apps/web/app/company/[id]/page.tsx","default")},73814:(e,t,s)=>{Promise.resolve().then(s.bind(s,72077))},74075:e=>{"use strict";e.exports=require("zlib")},77295:(e,t,s)=>{"use strict";s.d(t,{P:()=>c});var r=s(38049),a=s(24665),n=s(4574),i=s(86535),o=s(77943);function c(){let{chainId:e}=(0,r.F)(),t=(0,i.RZ)("DESTOCK",e??31337),{data:s,refetch:c}=(0,a.Q)({abi:i.$B,address:t,functionName:"nextCompanyId"}),{writeContractAsync:d,isPending:l,isConfirming:u,isConfirmed:p,error:m}=(0,n.x)(),x=async(e,s,r,a)=>{await d({abi:i.$B,address:t,functionName:"registerCompany",args:[e,BigInt(s),(0,o.g)(r),a]}),c()},{writeContractAsync:h}=(0,n.x)(),{writeContractAsync:g}=(0,n.x)();return{nextCompanyId:Number(s),registerCompany:x,isPending:l,isConfirming:u,isConfirmed:p,error:m,getCompany:e=>(0,a.Q)({abi:i.$B,address:t,functionName:"getCompanyDetails",args:[BigInt(e)]}),getSharePrice:e=>(0,a.Q)({abi:i.$B,address:t,functionName:"getSharePrice",args:[BigInt(e)]}),getBuyPrice:(e,s)=>(0,a.Q)({abi:i.$B,address:t,functionName:"getBuyPrice",args:[BigInt(e),BigInt(s)]}),getSellPrice:(e,s)=>(0,a.Q)({abi:i.$B,address:t,functionName:"getSellPrice",args:[BigInt(e),BigInt(s)]}),buyShares:h,sellShares:g}}},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},89250:(e,t,s)=>{"use strict";s.d(t,{W:()=>c});var r=s(38049),a=s(24665),n=s(4574),i=s(86535),o=s(77943);function c(){let{address:e,chainId:t}=(0,r.F)(),s=(0,i.RZ)("DSTK_TOKEN",t??31337),c=(0,i.RZ)("DESTOCK",t??31337),{data:d,refetch:l}=(0,a.Q)({abi:i.MO,address:s,functionName:"balanceOf",args:[e]}),{data:u,refetch:p}=(0,a.Q)({abi:i.MO,address:s,functionName:"allowance",args:[e,c]}),{writeContractAsync:m,isPending:x}=(0,n.x)(),h=async e=>{await m({abi:i.MO,address:s,functionName:"approve",args:[c,(0,o.g)(e)]}),p()},{writeContractAsync:g}=(0,n.x)(),{writeContractAsync:b}=(0,n.x)(),{writeContractAsync:y}=(0,n.x)();return{balance:d,allowance:u,approve:h,isApproving:x,mint:g,transferFromContract:b,batchAirDrop:y,refetchBalance:l,refetchAllowance:p}}},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},97374:(e,t,s)=>{Promise.resolve().then(s.bind(s,12690))}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[191,436,397,520],()=>s(2339));module.exports=r})();